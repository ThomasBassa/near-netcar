<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="style.css">
		<script type ="text/javascript"
			src="https://autobahn.s3.amazonaws.com/autobahnjs/latest/autobahn.min.jgz">
		</script>
		<script type="text/javascript"> //TODO separate into files
			//START AUTOBAHN
			var connection = new autobahn.Connection({
				url: 'ws://104.197.76.36:8080/ws',
				realm: 'realm1'
			});
			var mySession;
			var mode = "Manual";
			connection.onopen = function (session) {
				 // 1) subscribe to a topic
				function onevent(args) {
					console.log("Event:", args[0]);
				}
				session.subscribe('com.myapp.hello', onevent);

		  		 // 2) publish an event
				session.publish('com.myapp.hello', ['Hello, world!']);

				function accelerate(args) {
					return "accelerating!";
				}
				session.register('com.myapp.accelerate', accelerate);
				mySession=session;
			}
			
			function regCallDemo(){
				mySession.call('com.myapp.accelerate', [2, 3, 123, 421]).then(
					function (res) {
						console.log("Result:", res);
					}
				);
			}
			
			function rPCTest(){
				mySession.call('aero.near.joyMonitor', [-1]);
				// if(Math.random()>.5){
				// 	mySession.call('aero.near.joyMonitor', [Math.random()]);
				// }
				// else{
				// 	mySession.call('aero.near.joyMonitor', [Math.random()*-1]);
				// }
			}
			connection.open();
			//END AUTOBAHN
			
			function helloWorld() {
				console.log("Hello World");
			}
			function changeMode() {   // will be for the checkbox thing
				if(mode == "Manual")
					mode = "Automatic";
				else
					mode = "Manual";
			}
		</script>
	</head>
	<body>
		<div id="map-canvas"></div>
		<div id="camera-canvas"></div>
		<div id="buttonland">
			<!--<form action="demo_form.asp">
			<input type="checkbox" name="Mode" value="Auto"> Automatic Mode<br> --><!-- TODO MAKE PUBSUB-->
				<!--<input type="submit" value="Submit">
			</form>-->
			<button type="button" class=buttonstyle>TODO Automatic Mode</button>
			<button type="button" class="buttonstyle">TODO Help</button>
			<button onclick="regCallDemo()" class=buttonstyle>Accelerate!(regcalldemo)</button>
			<button type="button" class=buttonstyle>...</button>

			<button type="button" class=buttonstyle>TODO Manual Mode</button>
			<button type="button" class=buttonstyle>...</button>
			<button onclick="rPCTest()" class=buttonstyle>RPC Test!</button>
			<button onclick="helloWorld()" class=buttonstyle>Hello World onclick test</button>
		</div>
	</body>
</html>